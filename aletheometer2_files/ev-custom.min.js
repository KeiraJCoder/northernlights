{let gaaresponse={},rev_num=555,evo_client="cmp",siteHostname=document.location.hostname,liveURLS,evo_env="www.newstatesman.com"==siteHostname||"newstatesman.com"==siteHostname||"sotn.newstatesman.com"==siteHostname?"":".uat",postVisitTracker=new Object,logedIn=!1,paywallRender="",evSubscribe=document.getElementById("evSubscribe"),evSubscribe_m=document.getElementById("evSubscribe_m"),evSignIn=document.getElementById("evSignIn"),evSignIn_m=document.getElementById("evSignIn_m"),evMyAccount=document.getElementById("evMyAccount"),evLogout=document.getElementById("evLogout"),evLogout_m=document.getElementById("evLogout_m"),evLogedIn=document.getElementById("evLogedIn"),evLogedIn_m=document.getElementById("evLogedIn_m"),evNotLogedIn=document.getElementById("evNotLogedIn"),evNotLogedIn_m=document.getElementById("evNotLogedIn_m"),evLogedIn_mm=document.getElementById("evLogedIn_mm"),evNotLogedIn_mm=document.getElementById("evNotLogedIn_mm"),evoContentHolder;if(document.getElementsByClassName("c-evlok-page")[0]){let MYHTML=baseHREF+"/wp-content/plugins/nsmg-evolok-paywall/classes/assets/css/main.min.css?rev="+rev_num;link=document.createElement("link"),link.href=MYHTML,link.id="evolok_css",link.type="text/css",link.media="all",link.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(link)}function headerNavButtons(stat){setTimeout((function(){stat?(evNotLogedIn.style.display="none",evLogedIn.style.display="inline-block",evLogout.style.display="block",evNotLogedIn_m&&(evNotLogedIn_m.style.display="none",evLogedIn_m.style.display="inline-block",evLogout_m.style.display="block"),evLogedIn_mm.style.display="block",evNotLogedIn_mm.style.display="none"):(evNotLogedIn.style.display="inline-block",evLogedIn.style.display=evLogout.style.display="none",evSignIn.style.display="inline-block",evNotLogedIn_m&&(evNotLogedIn_m.style.display="inline-block",evLogedIn_m.style.display="none",evSignIn_m.style.display="inline-block"),evLogedIn_mm.style.display="none",evNotLogedIn_mm.style.display="block")}),50)}function hideContent(){let injectMessage="<div id='evolokPayWallMessage'></div>",getAllParagrafs;document.querySelectorAll(".c-article-content p").forEach((function(el,index){if(0==index){let child=document.createElement("p");child.className="signingInOrRegistering",child.innerHTML=injectMessage,el.after(child);let gradient=document.createElement("span");gradient.className="signingInOrRegistering__pGradient",el.classList.add("signingInOrRegistering__pHolder"),el.append(gradient)}else el.remove();EV.Em.on(EV.Em.Event.PAYWALL_RENDER_READY,(function(event){document.querySelector("#evolokPayWallMessage").innerHTML=event.detail.content}))})),document.querySelectorAll(".c-article-content h2").forEach((function(el,index){index>0&&el.remove()}))}function welcomeMessage(){let injectMessage="<div id='evolokWelcomeMessage'></div>",getAllParagrafs;document.querySelectorAll(".c-article-content p").forEach((function(el,index){if(0==index){let child=document.createElement("p");child.className="signingInOrRegistering",child.innerHTML=injectMessage,el.after(child)}EV.Em.on(EV.Em.Event.NOTIFIER_RENDER_READY,(function(event){"object"==typeof event&&"object"==typeof event.detail&&"welcome"==event.detail.widgetName&&(document.querySelector("#evolokWelcomeMessage").innerHTML=event.detail.content)}))}))}function loadCatFish(){let catfishJS=document.getElementById("catfishJS"),catfishCSS=document.getElementById("catfishCSS"),getObject=JSON.parse(params);if(catfishCSS&&catfishJS||"Subscribe"==getObject.title||"homepage"==getObject.title)showCatFish();else{if(!catfishCSS){let catfishCSSpath=baseHREF+"/wp-content/plugins/nsmg-evolok-paywall/classes/assets/css/catfish.css";link=document.createElement("link"),link.href=catfishCSSpath,link.id="catfishCSS",link.type="text/css",link.media="all",link.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(link)}catfishJS&&showCatFish()}}function preparePDFcontent(state){let showPDFcontent=document.getElementById("evo-login-page");if(showPDFcontent&&state){let hideLoginSection;showPDFcontent.style.display="block",document.querySelectorAll('ev-engagement[group-name="login"]')[0].style.display="none"}}function handleMeteringSuccess(response){let getHref=window.location.href;localStorage.setItem("evolok_authenticate",JSON.stringify(response));let prevArticle=document.referrer;localStorage.setItem("visitedArticle",prevArticle);let articleSlash,articleLinkSlash=localStorage.getItem("visitedArticle").split("/").length,articleLinkmod=localStorage.setItem("articleSlash",articleLinkSlash),visitedLinkSlash=window.location.href.split("/").length,visits=localStorage.setItem("visitslash",visitedLinkSlash),isGaaUser,isGoogleIntervention=0;var params;if(isGaa()&&(getQueryParams().resetshowcase&&GaaMeteringRegwall.signOut().then(()=>window.location.href="/"),isGoogleIntervention=checkEntitlements(response),-1!=isGoogleIntervention))return;function hudeStudentsDiscount(){if(window.location.href.includes("student")){let getDiscountLine=document.getElementById("studentDiscount");getDiscountLine?getDiscountLine.style.display="none":setTimeout((function(){hudeStudentsDiscount()}),500)}}if(setTimeout((function(){hudeStudentsDiscount()}),300),window.location.href.includes("student")){let getDiscountLine=document.getElementById("subscribeHeader");getDiscountLine&&(getDiscountLine.style.display="none")}if(response.activeMeter&&(postVisitTracker.user=!1,postVisitTracker.count=response.activeMeter.count,postVisitTracker.max=response.activeMeter.max,postVisitTracker.viewed=response.activeMeter.viewed),response.exceededMeter&&(postVisitTracker.user=!0,postVisitTracker.count=response.exceededMeter.count,postVisitTracker.max=response.exceededMeter.max,postVisitTracker.viewed=response.exceededMeter.viewed),response.auth)if(response.auth.loggedIn&&!response.loggedOut){if(getHref.includes("ev-login"))return void(window.location=baseHREF+"/my-account/");headerNavButtons(!0),logedIn=!0}else headerNavButtons(!1);else headerNavButtons(!1);let isSubscriber,isNotSubscriber,showCatfish=!0;Array.from(response.segments).forEach(el=>{"Subscriber"==el&&(showCatfish=!1)}),"ALLOW_ACCESS"==response.result?showCatfish&&welcomeMessage():"REQUIRE_ENTITLEMENT"==response.result?hideContent():(response.result,hideContent()),preparePDFcontent(logedIn)}function handleMeteringError(error){}function isGaa(){let params=getQueryParams();if(!params.gaa_at)return!1;if(!params.gaa_n)return!1;if(!params.gaa_sig)return!1;if(!params.gaa_ts)return!1;if(parseInt(params.gaa_ts,16)<Date.now()/1e3)return!1;let GOOGLE_DOMAIN_RE=/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,referrer=getAnchorFromUrl(document.referrer);return"https:"===referrer.protocol&&GOOGLE_DOMAIN_RE.test(referrer.hostname)||console.warn('SwG Entitlements: This pages referrer ("${referrer.origin}") cant grant Google Article Access. Real publications should bail if this referrer check fails.'),!0}function getQueryParams(){let queryParams={};return location.search.substring(1).split("&").forEach(pair=>{let parts=pair.split("=");queryParams[parts[0]]=parts[1]}),queryParams}function getAnchorFromUrl(url){let a=document.createElement("a");return a.href=url,a.hostname}EV.Em.init({url:"https://"+(".uat"==evo_env?"cmp.uat.evolok.net":"ev.newstatesman.com")+"/acd/api/3.0",sidCookieDomain:document.location.hostname.replace("www.",""),brand:"New Statesman"}),EV.Em.authorize(params,handleMeteringSuccess,handleMeteringError);let initSubscriptionsPromise=()=>new Promise((function(resolve,reject){(window.SWG=window.SWG||[]).push((function(subscriptions){subscriptions.init("newstatesman.com:showcase"),subscriptions.setOnNativeSubscribeRequest(()=>{window.location.href="/subscribe"}),subscriptions.setOnLoginRequest(()=>{window.location.href="/ev-login"}),subscriptions.getEventManager().then(manager=>{manager.registerEventListener(event=>{console.log(event)})}),subscriptions.setOnEntitlementsResponse(entitlements=>{entitlements.then(gaaEntitlements=>{gaaEntitlements&&gaaEntitlements.enablesThisWithGoogleMetering()?gaaEntitlements.consume(()=>{unlockArticle()}):(subscriptions.setShowcaseEntitlement({entitlement:"EVENT_SHOWCASE_NO_ENTITLEMENTS_PAYWALL",isUserRegister:!1}),console.log("EVENT_SHOWCASE_NO_ENTITLEMENTS_PAYWALL"),hideContent(),document.querySelector("#evolokPayWallMessage").innerHTML=paywallRender)})}).catch(error=>{console.log(error)}),gaaresponse.subscriptions=subscriptions,resolve(subscriptions)}))}));async function checkEntitlements(t){gaaresponse.session_id=t.sessionId,gaaresponse.auth_response=t;let isGoogleIntervention=0;initSubscriptionsPromise().then(subscriptions=>!!subscriptions&&("ALLOW_ACCESS"==t.result?"free"==t.userProperties.tags?(subscriptions.setShowcaseEntitlement({entitlement:"EVENT_SHOWCASE_UNLOCKED_FREE_PAGE",isUserRegister:!1}),console.log("EVENT_SHOWCASE_UNLOCKED_FREE_PAGE")):t.hasOwnProperty("activeMeter")?(subscriptions.setShowcaseEntitlement({entitlement:"EVENT_SHOWCASE_UNLOCKED_BY_METER",isUserRegister:!1}),console.log("EVENT_SHOWCASE_UNLOCKED_BY_METER")):t.segments.includes("Subscriber")&&(subscriptions.setShowcaseEntitlement({entitlement:"EVENT_SHOWCASE_UNLOCKED_BY_SUBSCRIPTION",isUserRegister:!0}),console.log("EVENT_SHOWCASE_UNLOCKED_BY_SUBSCRIPTION")):"ALLOW_ACCESS"!=t.result&&t.segments.includes("Not Authenticated")&&t.segments.includes("Not Subscriber")?(isGoogleIntervention=1,showGoogleRegwall()):"REQUIRE_ENTITLEMENT"==t.result&&t.segments.includes("Authenticated")&&t.segments.includes("Not Subscriber")?(isGoogleIntervention=1,EV.Em.on(EV.Em.Event.PAYWALL_RENDER_READY,(function(event){paywallRender=event.detail.content})),getUserStatePromise(t.pid).then((function(userState){subscriptions.getEntitlements(userState)}))):(subscriptions.setShowcaseEntitlement({entitlement:"EVENT_SHOWCASE_NO_ENTITLEMENTS_PAYWALL",isUserRegister:!1}),isGoogleIntervention=-1),isGoogleIntervention)).catch(e=>console.log(e))}let publisherEntitlementPromise=new Promise((function(myResolve,myReject){})),getUserStatePromise=attribute=>new Promise((function(resolve,reject){let profileUrl="",profileApi=baseHREF+"/wp-content/plugins/nsmg-evolok-paywall/google-client/userstate.php";profileUrl=void 0!==attribute?attribute.includes("@")?profileApi+"?email_address="+attribute:profileApi+"?user_guid="+attribute:profileApi;let settings={url:"",method:"GET",headers:{"cache-control":"no-cache"}};settings.url=profileUrl,jQuery.ajax(settings).done((function(userProperties){if(userProperties){const userData=JSON.parse(userProperties);if(userData.hasOwnProperty("guid")){let userState={metering:{state:{id:"",standardAttributes:{registered_user:{timestamp:""}}}}};userState.metering.state.id=userData.guid,userState.metering.state.standardAttributes.registered_user.timestamp=userData.created,resolve(userState)}}else reject(!1)}))})),registerUserPromise=userData=>new Promise((function(resolve,reject){console.log("registerUserPromise");let data={state:"",access_token:"",token_type:"Bearer",expires_in:1,scope:"email",authuser:"1",prompt:"none",client_id:"1054398729966-9gfv145j1tv8lh2oaen6jlvqqq591sjp.apps.googleusercontent.com",network:"google",display:"popup",expires:"",realmName:"default_realm",serviceName:"registration_social",attributesMapping:[{name:"email_address",value:"email"},{name:"first_name",value:"firstName"},{name:"last_name",value:"lastName"}]};data.access_token=userData.authorizationData.access_token,data.expires_in=userData.authorizationData.expires_in,data.expires=userData.authorizationData.expires_at,console.log(JSON.stringify(data));let settings={async:!0,crossDomain:!0,url:"https://"+(".uat"==evo_env?"cmp.uat.evolok.net":"ev.newstatesman.com")+"/ic/api/social/google/session?autoRegister=true&autoPopulate=true",method:"POST",headers:{"content-type":"application/json",Accept:"application/json",authorization:"Evolok evolok.api.service=registration_social evolok.api.sessionId=","cache-control":"no-cache"},processData:!1,data:JSON.stringify(data)};jQuery.ajax(settings).done((function(response,status,jqXHR){console.log(response);var n=response;if(n.hasOwnProperty("guid")){var i=!1,a=null;n.hasOwnProperty("mainSession")&&(i=n.mainSession.hasOwnProperty("sessionCookie")?n.mainSession.sessionCookie:i,a=n.mainSession.hasOwnProperty("expiry")?n.mainSession.expiry:a),EV.util.saveEVSessionInStorage(n,i,a)}data.guid=response.guid,data.pid=response.publicId,data.idToken=userData.idToken,data.userEmail=userData.email,resolve(data)})).fail((function(response){console.log("Register user Error.."),data.code=response.responseJSON.code,data.email=userData.email,reject(data)}))}));function showGoogleRegwall(){GaaMeteringRegwall.show({iframeUrl:baseHREF+"/wp-content/plugins/nsmg-evolok-paywall/google-client/registration_widget.html"}).then(userData=>{registerUserPromise(userData).then((function(profileObject){let userState;console.log(profileObject),sendUserState({email_address:profileObject.userEmail,guid:profileObject.guid,regtimestamp:Math.floor(Date.now()/1e3)})}),(function(error){"DUPLICATE_USER_PROFILE"==error.code&&getUserStatePromise(error.email).then((function(userState){gaaresponse.subscriptions.getEntitlements(userState)}))}))}).then(()=>{console.log("Already registered..")})}function sendUserState(profileObject){let userState={metering:{state:{id:"",standardAttributes:{registered_user:{timestamp:""}}}}};userState.metering.state.id=profileObject.guid,userState.metering.state.standardAttributes.registered_user.timestamp=profileObject.regtimestamp,userState&&gaaresponse.subscriptions.getEntitlements(userState)}function createAndSendUserState(profileObject){if(profileObject){let profileUrl=baseHREF+"/wp-content/plugins/nsmg-evolok-paywall/google-client/userprofile.php",userdata={};userdata.id_token=profileObject.idToken,userdata.user_guid=profileObject.guid;let settings={url:"",method:"POST",headers:{"cache-control":"no-cache"},data:userdata};settings.url=profileUrl,jQuery.ajax(settings).done((function(success){let userState;console.log(profileObject),sendUserState({email_address:profileObject.attributes[0].value,guid:profileObject.guid,regtimestamp:Math.floor(Date.now()/1e3)})}))}}function unlockArticle(){}if(EV.Widgets.asyncMode=!0,EV.Core.init({serviceName:"registration",realmName:"default_realm",icDomain:"https://"+(".uat"==evo_env?"cmp.uat.evolok.net":"ev.newstatesman.com")+"/ic/api",secureMode:!0,ssoCookieDomain:document.location.hostname.replace("www.",""),brand:"New Statesman"}),EV.Social.init({icDomain:"https://"+(".uat"==evo_env?"cmp.uat.evolok.net":"ev.newstatesman.com")+"/ic/api",serviceName:"registration_social",realmName:"default_realm",redirectUri:baseHREF+"/wp-content/plugins/nsmg-evolok-paywall/classes/assets/html/social_redirect.html",socialKeys:{facebook:"818896715404370",google:"1054398729966-9gfv145j1tv8lh2oaen6jlvqqq591sjp.apps.googleusercontent.com"},socialAttributeMapping:{email_address:"email",first_name:"firstName",last_name:"lastName"},brand:"New Statesman"}),EV.PM.init({pmDomain:"https://"+(".uat"==evo_env?"cmp.uat.evolok.net":"ev.newstatesman.com")+"/pm/api/v2",version:2,stripeKey:".uat"==evo_env?"pk_test_u1PiyRSnYl32b38YctzporQX":"pk_live_iGYXuxWCb49iOFMJ7G4F86Yy",gocardlessKey:".uat"==evo_env?"IGSHzVB1CwmN_veLf3S3ytG7YYOV84A_EA4O8HwL":"r6pl7ZbTOkybdM2SZKNYissworK71NEhMFUeQGet",brand:"New Statesman"}),EV.Translate.addTranslationTable("en",{"ev.widgets.accountactivation.danger":"Account Activation link is not valid","ev.widgets.accountactivation.success":"Account Activated successfully.","ev.widgets.accountactivation.warning":"Account Activation link is not valid","ev.widgets.attr.horizontal_password.label":"Password","ev.widgets.attr.new_password.confirm.label":"Confirm Password","ev.widgets.attr.new_password.confirm.placeholder":"Confirm Password","ev.widgets.attr.Password.confirm.label":"Confirm Password","ev.widgets.attr.Password.confirm.placeholder":"Password","ev.widgets.attr.password.label":"Password","ev.widgets.changepassword.buttons.cancel":"","ev.widgets.checkout.submit":"Confirm and Pay","ev.widgets.editprofile.buttons.cancel":"","ev.widgets.editprofile.buttons.submit":"Update Profile","ev.widgets.errors.500":"Error 500. Please try again shortly.","ev.widgets.errors.attribute_required":"Please populate the mandatory fields.","ev.widgets.errors.attribute_validation_failed":"Please check the values entered.","ev.widgets.errors.duplicate_user_profile":"Email already exits! Please use different email for signup.","ev.widgets.errors.edit_successful":"Profile Updated.","ev.widgets.errors.evolokexception":"Please enter valid details","ev.widgets.errors.evwidgetexception":"Please complete all fields below.","ev.widgets.errors.forgot_password_success":"Password reset email sent.","ev.widgets.errors.general_attributes":"The following fields are incorrect or empty [{0}]. These fields are mandatory for one or more services linked to your profile.","ev.widgets.errors.general_attribute":"The following field is incorrect or empty [{0}]. The field is mandatory for one or more services linked to your profile.","ev.widgets.errors.identifiers_invalid":"The password you have entered is incorrect. Please re-enter your password.","ev.widgets.errors.identifier_value_empty":"Please enter a valid email address.","ev.widgets.errors.idmex400":"Password must be 6 characters long, include a number & special character.","ev.widgets.errors.idmex409":"You already have an account. Please click below and log in using your email address.","ev.widgets.errors.invalid_form":"Please enter valid profile details.","ev.widgets.errors.invalid_profile":"Some of the data you provided seems to be incorrect or is missing. Please check your information and complete any errors. if you need help, please contact us on +44 20 7030 4927 or <a href='mailto:subs@newstatesman.co.uk'>subs@newstatesman.co.uk</a>","ev.widgets.errors.invalid_recaptcha_key":"Recaptcha key has been expired. Please reload the page.","ev.widgets.errors.messaging_template_not_found":"Email Template not Found.","ev.widgets.errors.minimum_security_level_not_met":"Minimum security level not met.","ev.widgets.errors.no_products_selected":"You need to select a product","ev.widgets.errors.reset_user_profile_not_found":"The link is no longer valid. Please try resetting your password.","ev.widgets.errors.undefined_order_id":"The order has not been created, the order ID is undefined.","ev.widgets.errors.unlink_user_social_network":"Please set a password to allow unlinking of your Social account.","ev.widgets.errors.user_attribute_update_forbidden":"Email Address cannot be updated.","ev.widgets.errors.user_not_registered":"You are not registered.","ev.widgets.errors.user_profile_identifiers_not_found":"Email address not found.","ev.widgets.errors.user_profile_inactive":"An email verification link was sent to your inbox.<br />Please check and verify your account. <a class='resend-activation' ng-click='resendActivation()'>Re-send email</a>","ev.widgets.errors.validators_value_empty":"Please enter a valid password.","ev.widgets.login.buttons.cancel":"Cancel","ev.widgets.login.buttons.submit":"Sign in","ev.widgets.plan.frequency.MONTH12":"Yearly","ev.widgets.plan.frequency.MONTH3":"Quarterly","ev.widgets.plan.frequency.MONTH1":"Monthly","ev.widgets.plan.frequency.DAY3":"3 Days","ev.widgets.productProfile.alreadyRegistered":"Already a user? Log in here!","ev.widgets.productProfile.selectProductWarning":"Please Select a Product","ev.widgets.productSelection.orderType.GIFT":"Click here if this is a gift subscription","ev.widgets.purchase.orderType.null":"","ev.widgets.productSelection.select":"Select","ev.widgets.productSelection.text.boosted":"Best Value","ev.widgets.productSelection.text.normal":"","ev.widgets.purchase.orderType.null":"","ev.widgets.purchases.actionsButton.label":"Manage","ev.widgets.purchases.beneficiariesInput.beneficiaryLabel":"Gift Recipient","ev.widgets.purchases.beneficiariesInput.beneficiaryPlaceholder":"Enter Gift Recipient Email","ev.widgets.purchases.beneficiariesInput.addBeneficiaryEmail":"Add Gift Recipient Email","ev.widgets.purchases.cancel.confirm":"Confirm cancellation","ev.widgets.purchases.changeCard.newCard.save":"Update Card","ev.widgets.registration.buttons.cancel":"Cancel","ev.widgets.registration.buttons.submit":"Create account","ev.widgets.resetpassword.buttons.cancel":"","ev.widgets.stripe.submitPayment":"Confirm and Pay","ev.widgets.userIdentifier.buttons.submit":"Continue with Email","ev.widgets.grant.noRecordsInvitationKeySpecified":"","ev.widgets.purchases.actionsButton.action.addBeneficiary":"Add Gift Recipient","ev.widgets.purchases.actionsButton.action.displayBeneficiaries":"Gift Recipients","ev.widgets.purchases.beneficiaries.title":"Remove Gift Recipient","ev.widgets.purchases.beneficiaries.noBeneficiaries":"No Gift Recipient","ev.widgets.purchases.notification.title":"Add Gift Recipient","ev.widgets.promo_code.enterPromo":"Promo Code","ev.widgets.social.linkaccounts.linkbutton":"Link Account","ev.widgets.social.unlinkaccounts.cardview.unlinkButton":"Unlink Account","ev.widgets.accountactivation.error":"Account Activation link is not valid or it has already been used.","ev.widgets.purchases.changeProductPlan.confirm":"Upgrade subscription","ev.widgets.purchases.actionsButton.action.changeProductPlan":"Upgrade subscription","ev.widgets.purchases.changeProductPlan.title":"Upgrade subscription","ev.widgets.purchases.changeProductPlan.select_new_plan":"Select new plan"}),EV.Translate.setActiveLanguage("en",!0),EV.Widgets=EV.Widgets||{},EV.Widgets.Display={NewStatesman_The_Morning_Call_by_Stephen_Bush:{type:"checkbox",values:{true:{caption:"Morning Call",id:"true"}}},newsletterWorldReview:{type:"checkbox",values:{true:{caption:"World Review ",id:"true"}}},newsletterWeeklyHighlights:{type:"checkbox",values:{true:{caption:"Weekly Highlights",id:"true"}}},newsletterCulture:{type:"checkbox",values:{true:{caption:"The Culture Edit",id:"true"}}},NS_Archive_Newsletter:{type:"checkbox",values:{true:{caption:"From the Archive",id:"true"}}},NS_Daily_Highlights_Newsletter:{type:"checkbox",values:{true:{caption:"The New Statesman Daily",id:"true"}}},delivery_address:{type:"label",values:[{caption:"Delivery Address",value:"Delivery Address"}]}},""!=document.referrer){const refer=new URL(document.referrer)}function goBack(event){"referrer"in document?window.location=document.referrer:window.history.back()}EV.Event.on(EV.Event.PM_PURCHASES_LOADED,(function(res){if(res){let loopFinder;function checkIfplanisHere(){let clickOnthisObject=document.querySelectorAll('[ng-click*="selectProduct"]');clickOnthisObject&&(clickOnthisObject[0].click(),clearInterval(loopFinder))}function checkIfObjectisHere(){let changeAplan=document.querySelectorAll('[aria-label="Change Product Plan"]');if(changeAplan[0]){for(i=0;i<changeAplan.length;i++)changeAplan[i].parentNode.parentNode.parentNode.classList.add("anm_holder-product-upgrade"),changeAplan[i].classList.add("anm_product-upgrade"),changeAplan[i].onclick=function(){loopFinder=setInterval(checkIfplanisHere,500)};clearInterval(checkMyObject)}}document.getElementById("contact_info").style.display="block",document.getElementById("subscrybe_button_holder").style.display="none";let checkMyObject=setInterval(checkIfObjectisHere,500)}else document.getElementById("contact_info").style.display="none",document.getElementById("subscrybe_button_holder").style.display="block",document.getElementById("subscrybe_button_holder").innerHTML='<a href="'+baseHREF+'/subscribe/" class="subscrybe_button">subscrybe</a>'})),EV.Event.publish(EV.Event.PM_VALIDATE_PROFILE,{serviceName:"billing",successCb:function(response){},errorCb:function(error){}}),EV.Event.on(EV.Event.ACC_ACTIVATION_SUCCESS,(function(){setTimeout((function(){window.location=baseHREF+"/ev-login/"}),750)})),EV.Event.on(EV.Event.PM_PRODUCTS_SELECTED,(function(res){let evProductSummary;EV.Event.publish(EV.Event.PM_PAYMENT_TYPE_CHANGED,"CARD"),document.querySelectorAll("ev-product-summary")[0].style.display="block"})),EV.Event.on(EV.Event.PM_PAYMENT_SUCCESS,(function(res){setTimeout((function(){null!=document.location.pathname.match("/subscribe/?$")?window.location=baseHREF+"/paymentsuccess?offer=default":null!=document.location.pathname.match("/xmas2021/?$")?window.location=baseHREF+"/paymentsuccess?offer=xmas2021":null!=document.location.pathname.match("/xmas21/?$")?window.location=baseHREF+"/paymentsuccess?offer=xmas21":null!=document.location.pathname.match("/editorsoffer/?$")?window.location=baseHREF+"/paymentsuccess?offer=editorsoffer":null!=document.location.pathname.match("/welcomeback/?$")?window.location=baseHREF+"/paymentsuccess?offer=welcomeback":window.location=baseHREF+"/paymentsuccess"}),750)})),EV.Event.on(EV.Event.PM_ERROR,(function(res){if("INVALID_FORM"==res.code){let profileObj;document.getElementById("productProfilePay").scrollIntoView({behavior:"smooth"})}})),EV.Event.on(EV.Event.PM_PRODUCTS_LOADED,(function(res){let queryParams=new URLSearchParams(window.location.search);if(""!=queryParams&&queryParams.get("productName")){document.getElementById("productProfilePay").style.display="unset";let containerHolder=document.getElementById("dynamicSubPage");document.getElementById("subscribeHeader").style.display="unset",containerHolder.classList.add("second-step")}else{let productItems;document.querySelectorAll(".product-item-container").forEach((function(i){i.addEventListener("click",(function(){productNameId=i.id,productName=productNameId.replace(/^product-/,""),queryParams.set("productName",productName),window.location=window.location.href.split("?")[0]+"?"+queryParams.toString()}))}));let planLists=document.querySelectorAll(".product-body");for(let j=0;j<planLists.length;j++)planLists[j].style.display="none";document.getElementById("subscribeHeader").style.display="unset"}}));const articleRedirect=()=>{let articleLink=localStorage.getItem("visitedArticle"),slashArticle=localStorage.getItem("articleSlash"),slashVisit=localStorage.getItem("visitslash");window.location=slashArticle===slashVisit?baseHREF+"/my-account/":articleLink};EV.Event.on("login.success",(function(res){headerNavButtons(!0),null==document.location.pathname.match("/login/?$")&&null==document.location.pathname.match("/ev-login/?$")?null!=document.location.pathname.match("/subscribe/?$")||(null!=document.location.pathname.match("/login/?$")||null!=document.location.pathname.match("/ev-login/?$")?null!=refer.pathname.match("/accept/?$")||null!=refer.pathname.match("/activate/?$")?window.location=baseHREF+"/my-account/":goBack():location.reload()):articleRedirect()})),EV.Event.on("login.failed",(function(res){})),EV.Event.on("registration.success",(function(res){})),EV.Event.on("registration.failed",(function(res){})),EV.Event.on(EV.Event.SOCIAL_LOGIN_SUCCESS,(function(res){articleRedirect()})),EV.Event.on(EV.Event.SOCIAL_LOGIN_FAILED,(function(res){})),EV.Event.on(EV.Event.SOCIAL_REGISTER_SUCCESS,(function(res){})),EV.Event.on(EV.Event.SOCIAL_REGISTER_FAILED,(function(res){})),EV.Event.on(EV.Event.PM_INVITATION_KEY_ACCEPTED,(function(){null!=document.location.pathname.match("/accept/?$")&&setTimeout((function(){window.location=baseHREF+"/my-account/?tab=1"}),750)})),EV.Event.on(EV.Event.PM_INVITATION_KEY_DECLINED,(function(){null!=document.location.pathname.match("/accept/?$")&&setTimeout((function(){window.location=baseHREF+"/my-account/"}),750)})),EV.Event.on(EV.Event.USER_IDENTIFIED,(function(){document.getElementById("evIdentifier").style.display="none",document.getElementById("evLogin").style.display="block"})),EV.Event.on(EV.Event.USER_NOT_FOUND,(function(){document.getElementById("evIdentifier").style.display="none",document.getElementById("evRegistration").style.display="block"})),EV.Event.on(EV.Event.LOGIN_CANCELLED,(function(){document.getElementById("evIdentifier").style.display="block",document.getElementById("evLogin").style.display="none"})),EV.Event.on(EV.Event.REGISTRATION_CANCELLED,(function(){document.getElementById("evIdentifier").style.display="block",document.getElementById("evRegistration").style.display="none"})),EV.Event.on("prepare_buttons",(function(){let list,mainHolder,currentTab=0,navClass="tab";function swapTabs(){let status;"0"==this.getAttribute("dev-state")&&(Array.from(list).forEach((el,index)=>{index==currentTab&&mainHolder[0].classList.remove("tab_"+index),el.setAttribute("dev-state","0")}),this.setAttribute("dev-state","1"),currentTab=Number(this.getAttribute("dev-number")),mainHolder[0].classList.add("tab_"+currentTab))}function profileNavigation(){const queryString=window.location.search,urlParams=new URLSearchParams(queryString),tab=urlParams.get("tab");currentTab=0==tab||null===tab?0:parseInt(tab);let listHolder=document.getElementById("profileNav");listHolder&&(list=listHolder.getElementsByTagName("li"),mainHolder=document.querySelectorAll('[group-name="myAccount"]'),mainHolder[0].classList.add("tab_"+currentTab),Array.from(list).forEach((el,index)=>{el.onclick=swapTabs,el.setAttribute("dev-number",index),index==currentTab?el.setAttribute("dev-state",1):el.setAttribute("dev-state",0)}))}profileNavigation()}))}